#
version: '0.1.1'
services:
  restapi:
    image: spil/spil
    build:
      dockerfile: ./spil_server/docker/Dockerfile
    restart: on-failure
    ports:
      - "80:80"

    # you can replace "./spil_hamlet_conf" by an actual config
    volumes:
      - ./spil_hamlet_conf:/spil_conf

    # for development: this is needed to make hot reload work (see below)
    environment:
      - WATCHFILES_FORCE_POLLING=true

    # for development: runs with hot reload, reloads server when the config folder changes
    command: ["uvicorn", "main:app", "--host", "0.0.0.0", "--port", "80", "--reload", "--reload-dir", "/spil_conf"]
    # See https://www.uvicorn.org/settings/